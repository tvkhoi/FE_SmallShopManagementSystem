<div class="sign-container">
  <div class="flex justify-center items-center min-h-screen">
    <nz-card class="auth-card w-[800px]" nzTitle="Đăng Ký" [nzBordered]="true" [nzHoverable]="true">
      <div class="text-center mb-3">
        <nz-avatar nzSize="large" nzShape="circle"
          nzSrc="https://pluspng.com/img-png/user-png-icon-account-avatar-human-male-man-men-people-person-download-svg-download-png-edit-icon-512.png">
        </nz-avatar>
      </div>

      <form nz-form [formGroup]="signUpForm" (ngSubmit)="signUp()">
        <div nz-row [nzGutter]="16">
          <!-- Họ và tên -->
          <div nz-col [nzSpan]="12">
            <nz-form-item>
              <nz-form-label [nzSpan]="24">Họ và Tên</nz-form-label>
              <nz-form-control [nzSpan]="24">
                <input nz-input formControlName="fullname" placeholder="Nhập họ và tên" />
              </nz-form-control>
            </nz-form-item>
          </div>

          <!-- Số điện thoại -->
          <div nz-col [nzSpan]="12">
            <nz-form-item>
              <nz-form-label [nzSpan]="24">Số điện thoại</nz-form-label>
              <nz-form-control [nzSpan]="24">
                <input nz-input type="tel" inputmode="numeric" maxlength="10" formControlName="phoneNumber"
                  placeholder="Nhập số điện thoại" />
                @if (signUpForm.get('phoneNumber')?.touched && signUpForm.get('phoneNumber')?.hasError('pattern')) {
                <div class="text-red-500 text-xs mt-1 list-disc">
                  Số điện thoại phải bắt đầu bằng 0 và có 10 số!
                </div>
                }
              </nz-form-control>
            </nz-form-item>
          </div>
        </div>

        <div nz-row [nzGutter]="16">
          <!-- Username -->
          <div nz-col [nzSpan]="12">
            <nz-form-item>
              <nz-form-label [nzSpan]="24" nzRequired>Tên đăng nhập</nz-form-label>
              <nz-form-control [nzSpan]="24">
                <input nz-input formControlName="username" placeholder="Nhập tên đăng nhập" />
                <div *ngIf="signUpForm.get('username')?.touched && signUpForm.get('username')?.hasError('required')"
                  class="text-red-500 text-xs mt-1 list-disc">
                  Vui lòng nhập tên đăng nhập!
                </div>
                <div *ngIf="signUpForm.get('username')?.hasError('whitespace')"
                  class="text-red-500 text-xs mt-1 list-disc">
                  Không được nhập toàn khoảng trắng!
                </div>

              </nz-form-control>
            </nz-form-item>
          </div>

          <!-- Email -->
          <div nz-col [nzSpan]="12">
            <nz-form-item>
              <nz-form-label [nzSpan]="24" nzRequired>Email</nz-form-label>
              <nz-form-control [nzSpan]="24">
                <input nz-input formControlName="email" placeholder="Nhập email" />
                <div *ngIf="signUpForm.get('email')?.touched && signUpForm.get('email')?.hasError('required')"
                  class="text-red-500 text-xs mt-1 list-disc">
                  Vui lòng nhập email!
                </div>
                <div *ngIf="signUpForm.get('email')?.touched && signUpForm.get('email')?.hasError('email')"
                  class="text-red-500 text-xs mt-1 list-disc">
                  Email không hợp lệ!
                </div>
              </nz-form-control>
            </nz-form-item>
          </div>
        </div>

        <!-- Địa chỉ -->
        <nz-form-item>
          <nz-form-label [nzSpan]="24">Địa chỉ</nz-form-label>
          <nz-form-control [nzSpan]="24">
            <input nz-input formControlName="address" placeholder="Nhập địa chỉ" />
          </nz-form-control>
        </nz-form-item>

        <div nz-row [nzGutter]="16">
          <!-- Mật khẩu -->
          <div nz-col [nzSpan]="12">
            <!-- Mật khẩu -->
            <nz-form-item>
              <nz-form-label [nzSpan]="24" nzRequired>Mật khẩu</nz-form-label>
              <nz-form-control [nzSpan]="24">
                <div class="password-wrapper">
                  <input nz-input [type]="passwordVisible ? 'text' : 'password'" formControlName="password"
                    placeholder="********" (focus)="passwordFocused = true" (blur)="passwordFocused = false" />
                  <button type="button" class="toggle-eye" (click)="passwordVisible = !passwordVisible"
                    aria-label="Ẩn/Hiện mật khẩu">
                    <nz-icon [nzType]="passwordVisible ? 'eye-invisible' : 'eye'"></nz-icon>
                  </button>
                </div>

                <!-- Policy -->
                <div>
                  <ul class="text-xs mt-1 list-disc">
                    <li *ngFor="let rule of pendingRules" class="text-red-500">
                      {{ rule }}
                    </li>
                  </ul>
                  <div *ngIf="signUpForm.get('password')?.hasError('whitespace')"
                    class="text-red-500 text-xs mt-1 list-disc">
                    Mật khẩu không được chứa khoảng trắng!
                  </div>
                </div>
              </nz-form-control>
            </nz-form-item>

          </div>

          <!-- Xác nhận mật khẩu -->
          <div nz-col [nzSpan]="12">
            <nz-form-item>
              <nz-form-label [nzSpan]="24" nzRequired>Xác nhận mật khẩu</nz-form-label>
              <nz-form-control [nzSpan]="24">
                <div class="password-wrapper">
                  <input nz-input [type]="confirmPasswordVisible ? 'text' : 'password'" formControlName="c_password"
                    placeholder="********" />
                  <button type="button" class="toggle-eye" (click)="confirmPasswordVisible = !confirmPasswordVisible"
                    aria-label="Ẩn/Hiện mật khẩu">
                    <nz-icon [nzType]="confirmPasswordVisible ? 'eye-invisible' : 'eye'"></nz-icon>
                  </button>
                </div>
                <div *ngIf="signUpForm.get('c_password')?.touched && signUpForm.hasError('notSame')"
                  class="text-red-500 text-xs mt-1">
                  Mật khẩu không khớp!
                </div>
                <div *ngIf="signUpForm.get('c_password')?.touched && signUpForm.get('c_password')?.hasError('required')"
                  class="text-red-500 text-xs mt-1">
                  Vui lòng xác nhận mật khẩu!
                </div>
              </nz-form-control>
            </nz-form-item>
          </div>
        </div>

        <div class="mt-3">
          <button nz-button nzType="primary" nzBlock="true" [disabled]="signUpForm.invalid || isLoading">
            {{ isLoading ? 'Đang đăng ký...' : 'Đăng Ký' }}
          </button>
        </div>

        <div class="text-center mt-3">
          Bạn đã có tài khoản? <a [routerLink]="['/login']">Đăng Nhập</a> tại đây.
        </div>
      </form>
    </nz-card>
  </div>
</div>